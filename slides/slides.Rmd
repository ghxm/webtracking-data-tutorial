---
title: "Working with Web Tracking Data"
subtitle: ""
author:
  - "Felix Schmidt"
  - "Maximilian Haag"
institute: ""
output:
    beamer_presentation:
        keep_tex: yes
        latex_engine: xelatex
aspectratio: 169
date: "`r Sys.Date()`"
theme: metropolis
colortheme: dove
fontfamily: sourcesanspro
fontsize: 10
header-includes: |
    \usepackage{relsize}
    % set the title background
    \pgfdeclareimage[width=\paperwidth,height=\paperheight]{bgtitle}{template/background3.pdf}
    \usebackgroundtemplate{\pgfuseimage{bgtitle}}
    \usefonttheme[onlylarge]{structurebold}
    \setbeamerfont{page number in head/foot}{size=\tiny}
    \date{\vspace{2.8em}\insertdate}
    % Redefine the frametitle to set the opacity of the filling and text
    \makeatletter
        \setbeamertemplate{frametitle}
        {
          \ifbeamercolorempty[bg]{frametitle}{}{\nointerlineskip}%
          \@tempdima=\textwidth%
          \advance\@tempdima by\beamer@leftmargin%
          \advance\@tempdima by\beamer@rightmargin%
          \pgfsetfillopacity{0}
          \begin{beamercolorbox}[sep=0.3cm,left,wd=\the\@tempdima]{frametitle}
            \usebeamerfont{frametitle}%
            \vbox{}\vskip-.45ex%
            \if@tempswa\else\csname beamer@fteleft\endcsname\fi%
            \strut\pgfsetfillopacity{1}\insertframetitle\strut\par%
            {%
              \ifx\insertframesubtitle\@empty%
              \else%
              {\usebeamerfont{framesubtitle}\usebeamercolor[fg]{framesubtitle}\insertframesubtitle\strut\par}%
              \fi
            }%
            \vskip-1ex%
            \if@tempswa\else\vskip-.3cm\fi%
          \end{beamercolorbox}%
        }
    \makeatother
    % Set a mode<all> command to include to use in include-before
    \newcommand{\modeall}{\mode<all>}
    \newcommand{\setbgimage}[1]{
        \modeall\usebackgroundtemplate{\includegraphics[width=\paperwidth]{#1}}
        \modeall\pgfdeclareimage[width=\paperwidth,height=\paperheight]{background}{#1}
        \modeall\usebackgroundtemplate{\pgfuseimage{background}}
        \mode*
    }
    % Set a default background image command
    \newcommand{\defaultbgimage}{template/background8.pdf}
    \newcommand{\setdefaultbgimage}{
        \setbgimage{\defaultbgimage}
    }
    % Set font color for title page elements
    \setbeamercolor{hrule}{fg=white}
    \setbeamercolor{title}{fg=white}
    \setbeamercolor{subtitle}{fg=white}
    \setbeamercolor{author}{fg=white}
    \setbeamercolor{institute}{fg=white}
    \setbeamercolor{date}{fg=white}
    % no footer for the title slide
    \setbeamertemplate{frame footer}{}
    % define a new title slide template
    \defbeamertemplate*{title page}{customized}[1][]
    {
      \vfill
      \usebeamerfont{title}\usebeamercolor[fg]{title}\inserttitle\par
      \usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\insertsubtitle\par
      \bigskip
      \bigskip
      \usebeamerfont{author}\insertauthor\par
      \usebeamerfont{institute}\insertinstitute\par
      \smallskip
      \usebeamerfont{date}\insertdate\par
    }
include-before: |
    \setdefaultbgimage
    \modeall\setbeamertemplate{frame footer}{\insertdate}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

# What is web tracking data?

- Records of individual-level browsing behavior collected via browser extensions or metering software
- Each record: **who** visited **what URL** at **what time**
- Typically linked with survey data (demographics, attitudes, etc.)

\bigskip

**Minimum data structure:**

| panelist_id | url | timestamp |
|:------------|:----|:----------|
| P001 | https://www.spiegel.de/politik/... | 2024-04-15 09:23:45 |
| P001 | https://www.google.com/search?q=... | 2024-04-15 09:24:12 |



# Our data today

**GESIS Panel Campusfile (ZA5670)**

- ~1.15 million URL visits from ~600 panelists
- Tracking period: April--June 2024
- Enhanced with **synthetic full URLs** for teaching purposes

\bigskip

**Data quality heterogeneity**

- **Full URLs** with paths and query parameters
- **Domain-only** entries, no path information
- **Privacy placeholders** ("blacked\_out", "full\_deny")

\bigskip

&rarr; Handling this heterogeneity is a core preprocessing challenge.


# What about HTML content?

In addition to URLs, we also collect the HTML content of visited pages.

&rarr; Working with HTMLs (parsing, text extraction, content analysis) will be covered in tomorrow's session.

\bigskip

\larger

Today's session focuses on **URL-level preprocessing** as the foundation.


# URL anatomy

\begin{center}
\includegraphics[width=0.85\textwidth]{../assets/url_anatomy.jpg}
\end{center}

\vspace{-0.2em}

\smaller\smaller Source: Clemm von Hohenberg et al. (2024), Fig. 2

\bigskip

Each component carries different information for analysis:

- **Domain/Host**: Which website (e.g., spiegel.de)
- **Path**: Which page or section (e.g., /politik/article-name)
- **Query parameters**: Search terms, filters, tracking codes


# The preprocessing workflow

1. **Parse URLs** -- Extract components (host, domain, path, query)
2. **Clean and deduplicate** -- Remove tracking artifacts, consecutive duplicates
3. **Classify visits** -- Assign categories (news, social, e-commerce, ...)
4. **Aggregate** -- Summarize per panelist, per category, per time period

\bigskip

Each step involves **decisions** that affect downstream analysis.



# Tools we'll use

**R packages:**

- `webtrackR` -- purpose-built for web tracking data preprocessing (extract, deduplicate, classify, aggregate)
- `adaR` -- robust URL parsing (alternative to manual regex)
- `dplyr` -- general data manipulation





```{=latex}
% Change the background mid-slides
% end the last slide
\end{frame}

% change the background image
\mode<all>\setbgimage{template/background12.pdf}

% start a new slide so that it will end when the next slide starts
\begin{frame}<0| handout:0>

```


# {.plain .c}

\color{white}

\LARGE
\centering

**Let's begin!**




```{=latex}
% Change the background mid-slides
% end the last slide
\end{frame}

% change the background image
\mode<all>\setbgimage{template/background8.pdf}

% start a new slide so that it will end when the next slide starts
\begin{frame}<0| handout:0>
```

<!---

# References {.allowframebreaks}

\begingroup

\footnotesize

::: {#refs}
:::

\endgroup

-->